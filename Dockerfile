# Шаг 1: берём базовый образ с Node.js
# "slim" — облегчённая версия, без лишнего мусора
FROM node:18-slim

# Шаг 2: создаём рабочую директорию внутри контейнера
WORKDIR /app

# Шаг 3: копируем package.json ОТДЕЛЬНО от кода
# Это хитрость для кэширования — если код изменился,
# но package.json нет — npm install не запустится снова
COPY package*.json ./
RUN npm install --production

# Шаг 4: копируем остальной код
COPY . .

# Шаг 5: говорим что сервер слушает порт 3000
EXPOSE 3000

# Шаг 6: команда запуска при старте контейнера
CMD ["node", "app.js"]